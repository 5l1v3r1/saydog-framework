#!/usr/bin/python3

import socket
import os,sys,time

u='\033[4m'
w='\x1b[00m'
r='\x1b[91m'
b='\x1b[36;1m'
y='\x1b[33m'

def banner(ip, port):
        s = socket.socket()
        s.connect((ip, int(port)))
        s.settimeout(5)
        print(s.recv(1024))

def exit():
        print(r+'[!]'+w+' The user forces it to stop')
        print(r+'[!]'+w+' Exiting program')
        sys.exit(1)
        
def corrupt():
        print(r+'[?]'+w+' Command not found, please type help')

def help():
        print('')
        print('BANNER GRABBER')
        print('------------')
        print('Banner Grabbing is a technique used to gain information')
        print('about a remote server and is often used as part of')
        print('a fingerprinting attack.')
        print('')
        print('command                                     example')
        print('-------                                     -------')
        print('set target [host]            set target 223.21.34.1')
        print('set port [port]                         set port 80')
        print('run, go, grab                                  grab')
        print('')

def main():
        global ip
        global port
        while True:
                try:
                        scn = input(w+'saydog('+r+'pytoolkit/portscanner'+w+') > ')
                        if scn == 'help':
                                help()
                        elif scn == 'clear':
                                os.system('clear')
                        elif scn == 'back':
                                sys.exit(0)
                        elif scn == 'exit':
                                exit()
                        elif 'set target' in scn:
                                ip = scn.split()[(-1)]
                                print('host > '+ip)
                        elif 'set port' in scn:
                                port = scn.split()[(-1)]
                                print('port > '+port)
                        elif scn == 'run' or scn == 'go' or scn == 'grab' or scn ==  'exploit':
                                banner(ip, port)
                        else:
                                corrupt()
                except socket.gaierror:
                        print(r+'[!]'+w+' No address associated with hostname')
                except KeyboardInterrupt:
                        exit()
                except ConnectionRefusedError:
                        print(r+'[!] '+w+'Connection refused: please try again later')
                except OSError:
                        print(r+'[!] '+w+'Network is unreachable')
                        

main()